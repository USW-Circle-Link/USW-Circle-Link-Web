"use strict";(self["webpackChunkdonggurami"]=self["webpackChunkdonggurami"]||[]).push([[374],{3096:function(e,s,o){e.exports=o.p+"img/dongurami_logo.842636f0.png"},4374:function(e,s,o){o.r(s),o.d(s,{default:function(){return A}});var t=o(6768),i=o(5130),n=o(4232),a=o(3096);const l={class:"login-container"},p={class:"login-box"},d={class:"errorMessage"},r={class:"dropdown-selected"},u={key:0,class:"dropdown-options"},c=["onClick"],h={key:0,class:"custom-popup"},g={class:"popup-content"},m={class:"popup-body"},f={class:"popup-message"};function k(e,s,o,k,v,w){return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.Lk)("div",l,[s[15]||(s[15]=(0,t.Fv)('<div class="header" data-v-389e4538><p class="subtitle" data-v-389e4538>수원대학교 동아리 통합 관리 서비스</p><div class="logo-container" data-v-389e4538><img src="'+a+'" alt="Dongurami Logo" class="logo" data-v-389e4538><span class="logo-text" data-v-389e4538>동구라미</span></div></div>',1)),(0,t.Lk)("div",p,[(0,t.Lk)("form",{onSubmit:s[7]||(s[7]=(0,i.D$)((...e)=>w.login&&w.login(...e),["prevent"])),autocomplete:"off"},[(0,t.Lk)("div",{class:(0,n.C4)(["input-group",{focused:"id"===v.focusedElement,"has-value":v.id.length>0}])},[s[9]||(s[9]=(0,t.Lk)("span",{class:"icon vector"},null,-1)),(0,t.bo)((0,t.Lk)("input",{type:"text",id:"id-input","onUpdate:modelValue":s[0]||(s[0]=e=>v.id=e),required:"",autocomplete:"off",onFocus:s[1]||(s[1]=e=>v.focusedElement="id"),onBlur:s[2]||(s[2]=e=>v.focusedElement=null)},null,544),[[i.Jo,v.id]]),s[10]||(s[10]=(0,t.Lk)("label",{for:"id-input",class:"floating-label"},"아이디",-1))],2),(0,t.Lk)("div",{class:(0,n.C4)(["input-group",{focused:"password"===v.focusedElement,"has-value":v.password.length>0}])},[s[11]||(s[11]=(0,t.Lk)("span",{class:"icon password"},null,-1)),(0,t.bo)((0,t.Lk)("input",{type:"password",id:"password-input","onUpdate:modelValue":s[3]||(s[3]=e=>v.password=e),required:"",autocomplete:"off",onFocus:s[4]||(s[4]=e=>v.focusedElement="password"),onBlur:s[5]||(s[5]=e=>v.focusedElement=null)},null,544),[[i.Jo,v.password]]),s[12]||(s[12]=(0,t.Lk)("label",{for:"password-input",class:"floating-label"},"비밀번호",-1))],2),(0,t.Lk)("span",d,(0,n.v_)(v.errorMessage),1),(0,t.Lk)("div",{class:(0,n.C4)(["custom-dropdown",{focused:"dropdown"===v.focusedElement}]),onClick:s[6]||(s[6]=(...e)=>w.toggleDropdown&&w.toggleDropdown(...e))},[(0,t.Lk)("div",r,(0,n.v_)(v.selectedOption||"동아리 관리자"),1),s[13]||(s[13]=(0,t.Lk)("span",{class:"dropdown-icon"},"▾",-1)),v.isOpen?((0,t.uX)(),(0,t.CE)("ul",u,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(v.options,e=>((0,t.uX)(),(0,t.CE)("li",{key:e,class:(0,n.C4)({"dropdown-option-selected":e===v.selectedOption}),onClick:s=>w.selectOption(e)},(0,n.v_)(e),11,c))),128))])):(0,t.Q3)("",!0)],2),s[14]||(s[14]=(0,t.Lk)("button",{type:"submit",class:"login-button"},"로그인",-1))],32)])]),v.showFailurePopup?((0,t.uX)(),(0,t.CE)("div",h,[(0,t.Lk)("div",g,[s[16]||(s[16]=(0,t.Lk)("div",{class:"popup-header"},[(0,t.Lk)("p",{class:"popup-title"},"로그인 실패")],-1)),s[17]||(s[17]=(0,t.Lk)("div",{class:"popup-separator"},null,-1)),(0,t.Lk)("div",m,[(0,t.Lk)("p",f,(0,n.v_)(v.failureMessage),1)]),(0,t.Lk)("button",{onClick:s[8]||(s[8]=e=>v.showFailurePopup=!1),class:"close-button"},"확인")])])):(0,t.Q3)("",!0)],64)}var v=o(4373),w=o(5968),E={name:"Login",data(){return{id:"",password:"",loginType:"LEADER",error:"",selectedOption:"동아리 관리자",options:["동아리 관리자","동아리 연합회"],isOpen:!1,showFailurePopup:!1,failureMessage:"",errorMessage:"",focusedElement:null}},methods:{toggleDropdown(){this.isOpen=!this.isOpen,this.focusedElement=this.isOpen?"dropdown":null},selectOption(e){this.selectedOption=e,this.isOpen=!1,this.focusedElement=null},validateInput(e){const s=["select","insert","update","delete"],o=new RegExp(s.join("|"),"i");return!(o.test(e)||/\s/.test(e))},async login(){if(!this.validateInput(this.id)||!this.validateInput(this.password))return this.error="로그인 중 오류가 발생했습니다. 다시 시도해주세요.",void alert(this.error);const e={"동아리 관리자":"LEADER","동아리 연합회":"ADMIN"};this.loginType=e[this.selectedOption];try{let e;if(e="LEADER"===this.loginType?await v.A.post(`${w.A.state.apiBaseUrl}/club-leader/login`,{leaderAccount:this.id,leaderPw:this.password,loginType:this.loginType}):await v.A.post(`${w.A.state.apiBaseUrl}/admin/login`,{adminAccount:this.id,adminPw:this.password,loginType:this.loginType}),!e.data)throw new Error("서버 응답에 데이터가 없습니다.");{const{message:s,data:o}=e.data,{accessToken:t,refreshToken:i,role:n,clubUUID:a,isAgreedTerms:l}=o,p={accessToken:t,refreshToken:i,role:n,clubUUID:a||null,isAgreedTerms:"boolean"===typeof l&&l};await this.$store.dispatch("setAuthData",p),"LEADER"===n?this.$router.push({name:"main",props:{isAgreedTerms:l}}):"ADMIN"===n&&this.$router.push({name:"adminmain"})}}catch(s){const{code:e}=s.response?.data||{};"USR-211"===e?this.errorMessage="* 아이디 또는 비밀번호가 일치하지 않아요.":"ATTEMPT-503"===e?(this.failureMessage="최대 시도 횟수를 초과했습니다. 1분 후 다시 시도 하세요.",this.showFailurePopup=!0):"BAD_REQUEST"===e?(this.failureMessage="잘못된 로그인 타입입니다. 다시 시도해주세요.",this.showFailurePopup=!0):(this.failureMessage="로그인 중 오류가 발생했습니다. 문제가 지속되면 관리자에게 문의해주세요.",this.showFailurePopup=!0)}}},mounted(){document.addEventListener("click",e=>{const s=e.target.closest(".custom-dropdown");!s&&this.isOpen&&(this.isOpen=!1,this.focusedElement=null)})},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)}},L=o(1241);const b=(0,L.A)(E,[["render",k],["__scopeId","data-v-389e4538"]]);var A=b}}]);
//# sourceMappingURL=374.e1baf9f9.js.map