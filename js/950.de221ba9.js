"use strict";(self["webpackChunkdonggurami"]=self["webpackChunkdonggurami"]||[]).push([[950],{5950:function(e,a,t){t.r(a),t.d(a,{default:function(){return N}});var s=t(6768),l=t(4232),i=t(5130),n=t(5039),r=t(6392);const c={class:"container"},o={class:"list"},u=["onClick"],d={class:"list-item-department"},p={class:"list-item-clubname"},b={class:"list-item-clubleader"},h={class:"list-item-numberOfClubMembers"},m={class:"list-item-delete"},P=["onClick"],v={class:"pagination"},k=["disabled"],g=["onClick"],C=["disabled"],w={key:0,class:"popup-overlay"},f={class:"popup"},L={class:"popup-message"},y={class:"popup-warning"};function E(e,a,t,E,I,A){const D=(0,s.g2)("Popup401");return(0,s.uX)(),(0,s.CE)(s.FK,null,[a[9]||(a[9]=(0,s.Fv)('<div class="title" data-v-5a1a7804>동아리 리스트</div><div class="header" data-v-5a1a7804><div class="header-row" data-v-5a1a7804><div class="header-item-department" data-v-5a1a7804>분과</div><div class="header-item-clubname" data-v-5a1a7804>동아리 이름</div><div class="header-item-clubleader" data-v-5a1a7804>동아리 회장</div><div class="header-item-numberOfClubMembers" data-v-5a1a7804>인원</div><div class="header-item-delete" data-v-5a1a7804></div></div></div>',2)),(0,s.Lk)("div",c,[(0,s.Lk)("div",o,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(I.clubs,(e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"list-item-container",key:a},[(0,s.Lk)("div",{class:"list-item-row",onClick:a=>A.openPopupClubInfo(e)},[(0,s.Lk)("div",d,(0,l.v_)(e.department),1),(0,s.Lk)("div",p,(0,l.v_)(e.clubName),1),(0,s.Lk)("div",b,(0,l.v_)(e.leaderName),1),(0,s.Lk)("div",h,(0,l.v_)(e.numberOfClubMembers),1)],8,u),(0,s.Lk)("div",m,[(0,s.Lk)("button",{class:"delete-btn",onClick:t=>A.openPopup(e.clubUUID,a,e.clubName)},"삭제",8,P)])]))),128))]),(0,s.Lk)("div",v,[(0,s.Lk)("button",{onClick:a[0]||(a[0]=(...e)=>A.prevPage&&A.prevPage(...e)),disabled:1===I.currentPage},a[5]||(a[5]=[(0,s.Lk)("img",{src:n,alt:"Previous"},null,-1)]),8,k),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(I.totalPages,e=>((0,s.uX)(),(0,s.CE)("button",{key:e,onClick:a=>A.setPage(e),class:(0,l.C4)({active:e===I.currentPage})},(0,l.v_)(e),11,g))),128)),(0,s.Lk)("button",{onClick:a[1]||(a[1]=(...e)=>A.nextPage&&A.nextPage(...e)),disabled:I.currentPage===I.totalPages},a[6]||(a[6]=[(0,s.Lk)("img",{src:r,alt:"Next"},null,-1)]),8,C)])]),I.isPopupVisible?((0,s.uX)(),(0,s.CE)("div",w,[(0,s.Lk)("div",f,[a[7]||(a[7]=(0,s.Lk)("h3",null,"동아리 삭제",-1)),a[8]||(a[8]=(0,s.Lk)("div",{class:"line2"},null,-1)),(0,s.Lk)("p",L,"'"+(0,l.v_)(I.PopupClubName)+"'을(를) 삭제하시겠습니까?",1),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>I.adminPw=e),type:"password",placeholder:"관리자 비밀번호"},null,512),[[i.Jo,I.adminPw]]),(0,s.Lk)("p",y,(0,l.v_)(I.adminPwError),1),(0,s.Lk)("button",{class:"expel-button",onClick:a[3]||(a[3]=(...e)=>A.confirmDelete&&A.confirmDelete(...e))},"확인"),(0,s.Lk)("button",{class:"cancel-button",onClick:a[4]||(a[4]=(...e)=>A.cancelDelete&&A.cancelDelete(...e))},"취소")])])):(0,s.Q3)("",!0),I.show401Popup?((0,s.uX)(),(0,s.Wv)(D,{key:1})):(0,s.Q3)("",!0)],64)}var I=t(4373),A=t(5968),D=t(6799),_={name:"ClubProfile",components:{Popup401:D.A},data(){return{currentPage:1,clubsPerPage:10,clubs:[],totalPages:1,isPopupVisible:!1,isClubInfoPopupVisible:!1,adminPw:"",adminPwError:"",clubToDelete:null,deleteIndex:null,PopupClubName:null,show401Popup:!1}},created(){this.fetchClubs()},methods:{handle401Error(e){return!(!e.response||401!==e.response.status)&&(this.show401Popup=!0,!0)},async fetchClubs(){try{const e=await I.A.get(`${A.A.state.apiBaseUrl}/admin/clubs`,{headers:{Authorization:`Bearer ${A.A.state.accessToken}`},params:{page:this.currentPage-1,size:this.clubsPerPage}}),{content:a,totalPages:t}=e.data.data;this.clubs=a||[],this.totalPages=t||1}catch(e){this.handle401Error(e)||console.error("Error updating member:",e)}},async setPage(e){e>0&&e<=this.totalPages&&(this.currentPage=e,await this.fetchClubs())},async prevPage(){this.currentPage>1&&(this.currentPage--,await this.fetchClubs())},async nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,await this.fetchClubs())},openPopup(e,a,t){this.PopupClubName=t,this.clubToDelete=e,this.deleteIndex=a,this.isPopupVisible=!0},cancelDelete(){this.isPopupVisible=!1,this.adminPw=""},async confirmDelete(){if(this.adminPw)try{await I.A.delete(`${A.A.state.apiBaseUrl}/admin/clubs/${this.clubToDelete}`,{headers:{Authorization:`Bearer ${A.A.state.accessToken}`},data:{adminPw:this.adminPw}}),this.clubs.splice(this.deleteIndex,1),this.isPopupVisible=!1,alert("동아리가 성공적으로 삭제되었습니다.")}catch(e){this.handle401Error(e)||console.error("Error updating member:",e),400===e.response.status&&(this.adminPwError="* 비밀번호를 다시 확인해주세요.")}else alert("관리자 비밀번호를 입력하세요.")},openPopupClubInfo(e){localStorage.setItem("accessToken",A.A.state.accessToken);const a=712,t=960;window.open(`/club-popup?clubId=${e.clubUUID}`,"ClubInfo",`width=${a},height=${t},scrollbars=yes,resizable=yes`)}}},x=t(1241);const $=(0,x.A)(_,[["render",E],["__scopeId","data-v-5a1a7804"]]);var N=$}}]);
//# sourceMappingURL=950.de221ba9.js.map