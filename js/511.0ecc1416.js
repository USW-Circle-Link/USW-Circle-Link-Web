"use strict";(self["webpackChunkdonggurami"]=self["webpackChunkdonggurami"]||[]).push([[511],{3096:function(e,s,o){e.exports=o.p+"img/dongurami_logo.842636f0.png"},7511:function(e,s,o){o.r(s),o.d(s,{default:function(){return b}});var t=o(6768),n=o(5130),i=o(4232),l=o(3096);const a={class:"login-container"},d={class:"login-box"},p={class:"dropdown-selected"},u={key:0,class:"dropdown-options"},r=["onClick"],c={key:0,class:"custom-popup"},h={class:"popup-content"},g={class:"popup-body"},m={class:"popup-message"};function f(e,s,o,f,k,v){return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.Lk)("div",a,[s[15]||(s[15]=(0,t.Fv)('<div class="header" data-v-0d020378><p class="subtitle" data-v-0d020378>수원대학교 동아리 통합 관리 서비스</p><div class="logo-container" data-v-0d020378><img src="'+l+'" alt="Dongurami Logo" class="logo" data-v-0d020378><span class="logo-text" data-v-0d020378>동구라미</span></div></div>',1)),(0,t.Lk)("div",d,[(0,t.Lk)("form",{onSubmit:s[7]||(s[7]=(0,n.D$)((...e)=>v.login&&v.login(...e),["prevent"])),autocomplete:"off"},[(0,t.Lk)("div",{class:(0,i.C4)(["input-group",{focused:"id"===k.focusedElement,"has-value":k.id.length>0}])},[s[9]||(s[9]=(0,t.Lk)("span",{class:"icon vector"},null,-1)),(0,t.bo)((0,t.Lk)("input",{type:"text",id:"id-input","onUpdate:modelValue":s[0]||(s[0]=e=>k.id=e),required:"",autocomplete:"off",onFocus:s[1]||(s[1]=e=>k.focusedElement="id"),onBlur:s[2]||(s[2]=e=>k.focusedElement=null)},null,544),[[n.Jo,k.id]]),s[10]||(s[10]=(0,t.Lk)("label",{for:"id-input",class:"floating-label"},"아이디",-1))],2),(0,t.Lk)("div",{class:(0,i.C4)(["input-group",{focused:"password"===k.focusedElement,"has-value":k.password.length>0}])},[s[11]||(s[11]=(0,t.Lk)("span",{class:"icon password"},null,-1)),(0,t.bo)((0,t.Lk)("input",{type:"password",id:"password-input","onUpdate:modelValue":s[3]||(s[3]=e=>k.password=e),required:"",autocomplete:"off",onFocus:s[4]||(s[4]=e=>k.focusedElement="password"),onBlur:s[5]||(s[5]=e=>k.focusedElement=null)},null,544),[[n.Jo,k.password]]),s[12]||(s[12]=(0,t.Lk)("label",{for:"password-input",class:"floating-label"},"비밀번호",-1))],2),(0,t.Lk)("div",{class:(0,i.C4)(["custom-dropdown",{focused:"dropdown"===k.focusedElement}]),onClick:s[6]||(s[6]=(...e)=>v.toggleDropdown&&v.toggleDropdown(...e))},[(0,t.Lk)("div",p,(0,i.v_)(k.selectedOption||"동아리 관리자"),1),s[13]||(s[13]=(0,t.Lk)("span",{class:"dropdown-icon"},"▾",-1)),k.isOpen?((0,t.uX)(),(0,t.CE)("ul",u,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(k.options,e=>((0,t.uX)(),(0,t.CE)("li",{key:e,class:(0,i.C4)({"dropdown-option-selected":e===k.selectedOption}),onClick:s=>v.selectOption(e)},(0,i.v_)(e),11,r))),128))])):(0,t.Q3)("",!0)],2),s[14]||(s[14]=(0,t.Lk)("button",{type:"submit",class:"login-button"},"로그인",-1))],32)])]),k.showFailurePopup?((0,t.uX)(),(0,t.CE)("div",c,[(0,t.Lk)("div",h,[s[16]||(s[16]=(0,t.Lk)("div",{class:"popup-header"},[(0,t.Lk)("p",{class:"popup-title"},"로그인 실패")],-1)),s[17]||(s[17]=(0,t.Lk)("div",{class:"popup-separator"},null,-1)),(0,t.Lk)("div",g,[(0,t.Lk)("p",m,(0,i.v_)(k.failureMessage),1)]),(0,t.Lk)("button",{onClick:s[8]||(s[8]=e=>k.showFailurePopup=!1),class:"close-button"},"확인")])])):(0,t.Q3)("",!0)],64)}var k=o(4373),v=o(5968),w={name:"Login",data(){return{id:"",password:"",loginType:"LEADER",error:"",selectedOption:"동아리 관리자",options:["동아리 관리자","동아리 연합회 / 개발팀"],isOpen:!1,showFailurePopup:!1,failureMessage:"",focusedElement:null}},methods:{toggleDropdown(){this.isOpen=!this.isOpen,this.focusedElement=this.isOpen?"dropdown":null},selectOption(e){this.selectedOption=e,this.isOpen=!1,this.focusedElement=null},validateInput(e){const s=["select","insert","update","delete"],o=new RegExp(s.join("|"),"i");return!o.test(e)&&!/\s/.test(e)},async login(){if(!this.validateInput(this.id)||!this.validateInput(this.password))return this.error="로그인 중 오류가 발생했습니다. 다시 시도해주세요.",void alert(this.error);const e={"동아리 관리자":"LEADER","동아리 연합회 / 개발팀":"ADMIN"};this.loginType=e[this.selectedOption];try{let e;if(e="LEADER"===this.loginType?await k.A.post(`${v.A.state.apiBaseUrl}/club-leader/login`,{leaderAccount:this.id,leaderPw:this.password,loginType:this.loginType}):await k.A.post(`${v.A.state.apiBaseUrl}/admin/login`,{adminAccount:this.id,adminPw:this.password,loginType:this.loginType}),!e.data)throw new Error("서버 응답에 데이터가 없습니다.");{const{message:s,data:o}=e.data,{accessToken:t,refreshToken:n,role:i,clubUUID:l,isAgreedTerms:a}=o,d={accessToken:t,refreshToken:n,role:i,clubUUID:l||null,isAgreedTerms:"boolean"===typeof a&&a};await this.$store.dispatch("setAuthData",d),"LEADER"===i?this.$router.push({name:"main",props:{isAgreedTerms:a}}):"ADMIN"===i&&this.$router.push({name:"adminmain"})}}catch(s){const{code:e}=s.response?.data||{};this.failureMessage="USR-211"===e?"아이디 또는 비밀번호가 일치하지 않습니다.":"ATTEMPT-503"===e?"최대 시도 횟수를 초과했습니다. 1분 후 다시 시도 하세요.":"BAD_REQUEST"===e?"잘못된 로그인 타입입니다. 다시 시도해주세요.":"로그인 중 오류가 발생했습니다. 다시 시도해주세요....",this.showFailurePopup=!0}}},mounted(){document.addEventListener("click",e=>{const s=e.target.closest(".custom-dropdown");!s&&this.isOpen&&(this.isOpen=!1,this.focusedElement=null)})},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)}},E=o(1241);const L=(0,E.A)(w,[["render",f],["__scopeId","data-v-0d020378"]]);var b=L}}]);
//# sourceMappingURL=511.0ecc1416.js.map