"use strict";(self["webpackChunkdonggurami"]=self["webpackChunkdonggurami"]||[]).push([[624],{7624:function(s,e,t){t.r(e),t.d(e,{default:function(){return C}});var a=t(6768),o=t(4232);const i={class:"MainBox"},n={class:"status-actions"},p={class:"status-boxes"},l={class:"contents"},c={class:"applicant-list"},r={class:"buttons-group"},u=["onClick"],d={key:0,class:"popup-overlay"},h={class:"popup"},k={class:"popup-buttons"},m={key:0,class:"popup-overlay"},L={class:"unexpectedPopup"},f={class:"unexpectedPopup-buttons"};function A(s,e,t,A,P,v){const U=(0,a.g2)("Popup401");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",i,[e[11]||(e[11]=(0,a.Lk)("div",{class:"header"},[(0,a.Lk)("p",{class:"common"},"지원자 추가 합격 처리")],-1)),(0,a.Lk)("div",n,[(0,a.Lk)("button",{class:"send-result-btn",onClick:e[0]||(e[0]=(...s)=>v.showPopup&&v.showPopup(...s))},"추가 합격 결과 전송"),(0,a.Lk)("div",p,[(0,a.Lk)("button",{class:"status-box approve-box",onClick:e[1]||(e[1]=s=>v.setAllApplicantsStatus("PASS"))},e[5]||(e[5]=[(0,a.eW)("전체"),(0,a.Lk)("br",null,null,-1),(0,a.eW)("합격")]))])]),(0,a.Lk)("div",l,[(0,a.Lk)("div",c,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(P.applicants,s=>((0,a.uX)(),(0,a.CE)("div",{class:"applicant-item",key:s.aplictUUID},[(0,a.Lk)("p",null,(0,o.v_)(s.userName),1),(0,a.Lk)("p",null,(0,o.v_)(s.studentNumber),1),(0,a.Lk)("p",null,(0,o.v_)(s.major),1),(0,a.Lk)("p",null,(0,o.v_)(s.userHp),1),(0,a.Lk)("div",r,[(0,a.Lk)("label",{class:(0,o.C4)({checked:"PASS"===s.decision}),onClick:e=>v.toggleDecision(s,"PASS")},e[6]||(e[6]=[(0,a.Lk)("span",{class:"check-icon"},null,-1)]),10,u)])]))),128))])]),P.showConfirmPopup?((0,a.uX)(),(0,a.CE)("div",d,[(0,a.Lk)("div",h,[e[7]||(e[7]=(0,a.Lk)("h2",null,"추가 합격 결과 전송",-1)),e[8]||(e[8]=(0,a.Lk)("hr",null,null,-1)),e[9]||(e[9]=(0,a.Lk)("p",{class:"confirm-message"},"추가 합격 처리를 확정 하시겠습니까?",-1)),e[10]||(e[10]=(0,a.Lk)("p",{class:"notice-message"},"확정 후 지원자에게 알림이 발송 되니 신중하게 선택해 주세요.",-1)),(0,a.Lk)("div",k,[(0,a.Lk)("button",{onClick:e[2]||(e[2]=(...s)=>v.hidePopup&&v.hidePopup(...s))},"취소"),(0,a.Lk)("button",{onClick:e[3]||(e[3]=(...s)=>v.confirmSendResults&&v.confirmSendResults(...s))},"확정")])])])):(0,a.Q3)("",!0)]),P.showUnexpectedErrorPopup?((0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("div",L,[e[12]||(e[12]=(0,a.Lk)("h2",null,"동구라미",-1)),e[13]||(e[13]=(0,a.Lk)("hr",null,null,-1)),e[14]||(e[14]=(0,a.Lk)("p",{class:"confirm-message"},[(0,a.Lk)("span",{class:"error-highlight"},"예기치 못한 오류"),(0,a.eW)("가 발생했습니다."),(0,a.Lk)("br"),(0,a.eW)("문제가 계속될 시, 관리자에게 문의해주세요.")],-1)),(0,a.Lk)("div",f,[(0,a.Lk)("button",{onClick:e[4]||(e[4]=(...s)=>v.hideUnexpectedErrorPopup&&v.hideUnexpectedErrorPopup(...s))},"확인")])])])):(0,a.Q3)("",!0),P.show401Popup?((0,a.uX)(),(0,a.Wv)(U,{key:1})):(0,a.Q3)("",!0)],64)}var P=t(4373),v=t(5968),U=t(1720),b={name:"ApplicantManagement",components:{Popup401:U.A},data(){return{applicants:[],showConfirmPopup:!1,notification:{message:"",type:""},fetchUrl:`${v.A.state.apiBaseUrl}/club-leader/${v.A.state.clubUUID}/failed-applicants`,submitUrl:`${v.A.state.apiBaseUrl}/club-leader/${v.A.state.clubUUID}/failed-applicants/notifications`,show401Popup:!1,showUnexpectedErrorPopup:!1}},mounted(){this.fetchApplicants()},methods:{handle401Error(s){return!(!s.response||401!==s.response.status)&&(this.show401Popup=!0,!0)},async fetchApplicants(){try{const s=await P.A.get(this.fetchUrl,{headers:{Authorization:`Bearer ${v.A.state.accessToken}`,"Content-Type":"application/json"}}),e=s.data.data;e&&Array.isArray(e)&&(this.applicants=e.map(s=>({aplictUUID:s.aplictUUID,userName:s.userName,studentNumber:s.studentNumber,major:s.major,userHp:s.userHp,decision:null})),this.showNotification("지원자 목록을 성공적으로 가져왔습니다.","success"))}catch(s){this.handle401Error(s)||alert("동아리 정보를 불러오는데 실패했습니다.","error")}},showPopup(){this.showConfirmPopup=!0},hidePopup(){this.showConfirmPopup=!1},hideUnexpectedErrorPopup(){this.showUnexpectedErrorPopup=!1},confirmSendResults(){this.hidePopup(),this.sendResults()},validateResults(){const s=this.applicants.some(s=>null!==s.decision);return!!s||(alert("최소 한 명 이상의 지원자에 대해 합/불 상태를 설정해 주세요."),!1)},async sendResults(){if(!this.validateResults())return;const s=this.applicants.filter(s=>null!==s.decision),e=s.map(s=>({aplictUUID:s.aplictUUID,aplictStatus:s.decision}));try{await P.A.post(this.submitUrl,e,{headers:{Authorization:`Bearer ${v.A.state.accessToken}`,"Content-Type":"application/json"}});this.showNotification("결과가 성공적으로 전송되었습니다.","success"),await this.fetchApplicants()}catch(t){if("CMEM-202"===t.response?.data?.code)alert("이미 동아리원으로 등록된 지원자가 있습니다. 관리자에게 문의하세요.","error");else if(this.handle401Error(t))"INVALID_ARGUMENT"===errorData.code?this.showUnexpectedErrorPopup=!0:alert(errorData.message||"결과 전송에 실패했습니다.","error");else{const s=t.response?.data?.message||"결과 전송에 실패했습니다.";alert(s,"error")}}},toggleDecision(s,e){["PASS","FAIL"].includes(e)?s.decision===e?s.decision=null:s.decision=e:alert("잘못된 합격/불합격 상태입니다. 상태는 PASS 또는 FAIL이어야 합니다.","error")},setAllApplicantsStatus(s){this.applicants.forEach(e=>{e.decision=s})},showNotification(s,e){this.notification.message=s,this.notification.type=e,setTimeout(()=>{this.notification.message=""},3e3)}}},g=t(1241);const w=(0,g.A)(b,[["render",A],["__scopeId","data-v-19c9eca8"]]);var C=w}}]);
//# sourceMappingURL=624.4541968d.js.map