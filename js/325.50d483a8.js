"use strict";(self["webpackChunkdonggurami"]=self["webpackChunkdonggurami"]||[]).push([[325],{4325:function(e,s,t){t.r(s),t.d(s,{default:function(){return P}});var a=t(6768),r=t(4232),o=t(5130);const c={class:"container"},n={class:"category-list"},i=["onClick"],l={class:"category-add"},p={class:"error"};function u(e,s,t,u,g,d){const h=(0,a.g2)("AddCategoryPopup"),y=(0,a.g2)("Popup401");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",c,[s[2]||(s[2]=(0,a.Lk)("div",{class:"title"},"카테고리 작성하기",-1)),s[3]||(s[3]=(0,a.Lk)("h2",null,"카테고리 리스트",-1)),(0,a.Lk)("div",n,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(g.categories,(e,s)=>((0,a.uX)(),(0,a.CE)("span",{key:s,class:"category-item"},[(0,a.eW)((0,r.v_)(e)+" ",1),(0,a.Lk)("button",{class:"remove-btn",onClick:t=>d.removeCategory(e,s)},"×",8,i)]))),128))]),s[4]||(s[4]=(0,a.Lk)("div",{class:"line"},null,-1)),s[5]||(s[5]=(0,a.Lk)("h2",null,"카테고리 추가",-1)),(0,a.Lk)("div",l,[(0,a.bo)((0,a.Lk)("input",{ref:"inputField","onUpdate:modelValue":s[0]||(s[0]=e=>g.categoryName=e),type:"text",placeholder:"추가할 카테고리를 작성해주세요.",class:"input-field"},null,512),[[o.Jo,g.categoryName]]),(0,a.Lk)("p",p,(0,r.v_)(g.errorMsg),1),(0,a.Lk)("button",{class:"save-btn",onClick:s[1]||(s[1]=(...e)=>d.addCategory&&d.addCategory(...e))},"저장하기")])]),g.showPopup?((0,a.uX)(),(0,a.Wv)(h,{key:0,serverMessage:g.serverMessage,onClose:d.closeResultPopup},null,8,["serverMessage","onClose"])):(0,a.Q3)("",!0),g.show401Popup?((0,a.uX)(),(0,a.Wv)(y,{key:1})):(0,a.Q3)("",!0)],64)}var g=t(4373),d=t(5968),h=t(6799);const y={class:"popup-overlay"},v={class:"popup"},m=["innerHTML"];function k(e,s,t,r,o,c){return(0,a.uX)(),(0,a.CE)("div",y,[(0,a.Lk)("div",v,[s[1]||(s[1]=(0,a.Lk)("div",{class:"popup-header"},"카테고리 설정",-1)),(0,a.Lk)("p",{innerHTML:c.message,class:"confirm-message"},null,8,m),(0,a.Lk)("button",{onClick:s[0]||(s[0]=s=>e.$emit("close")),class:"confirm-button"},"확인")])])}var C={name:"AddCategoryPopup",props:{serverMessage:{type:String,required:!0}},computed:{message(){return this.serverMessage}}},M=t(1241);const A=(0,M.A)(C,[["render",k],["__scopeId","data-v-ac07046e"]]);var b=A,f={components:{AddCategoryPopup:b,Popup401:h.A},data(){return{categories:[],categoryName:"",categoryMap:new Map,showPopup:!1,serverMessage:"",serverPopHead:"",errorMsg:"",show401Popup:!1}},mounted(){this.fetchCategory()},methods:{handle401Error(e){const{code:s}=e.response?.data||{};return(401===s||"UNAUTHORIZED"===s)&&(this.show401Popup=!0,!0)},async fetchCategory(){try{const e=await g.A.get(`${d.A.state.apiBaseUrl}/admin/clubs/category`,{headers:{Authorization:`Bearer ${d.A.state.accessToken}`}}),s=e.data;s&&Array.isArray(s.data)&&(this.categories=s.data.map(e=>e.clubCategoryName),console.log(this.categories),this.categoryMap.clear(),s.data.forEach(e=>{this.categoryMap.set(e.clubCategoryName,e.clubCategoryUUID)})),console.log("카테고리 불러오기 성공",this.categoryMap)}catch(e){this.handle401Error(e)||console.error("Error updating member:",e)}},async addCategory(){const e=/[!@#$%^&*(),.?":;{}|<>/'+=-`_']/,s=/\s+/,t=this.categoryName.trim();if(""!==t&&!this.categories.includes(t)&&!e.test(t)&&t.length<=10)try{const e=await g.A.post(`${d.A.state.apiBaseUrl}/admin/clubs/category`,this.categoryName,{headers:{Authorization:`Bearer ${d.A.state.accessToken}`,"Content-Type":"application/json"}});if(e.data&&e.data.data){const s=e.data.data.clubCategoryUUID;this.categoryMap.set(t,s),this.categories.push(t)}this.serverMessage="카테고리가 정상적으로 저장되었습니다.",this.showPopup=!0,this.categoryName=""}catch(a){const{code:e}=a.response?.data||{};"INVALID_REQUEST_BODY"===e&&(this.errorMsg="* 카테고리는 공백, 특수문자 제외 1~10자 이내로 작성해주세요.")}else this.categories.includes(t)?(this.serverMessage="이미 존재하는 카테고리에요.",this.showPopup=!0):(!t.length<=10||s.test(t)||e.test(t))&&(this.errorMsg="* 카테고리는 공백, 특수문자 제외 1~10자 이내로 작성해주세요.")},async removeCategory(e,s){const t=this.categoryMap.get(e);if(t)try{await g.A.delete(`${d.A.state.apiBaseUrl}/admin/clubs/category/${t}`,{headers:{Authorization:`Bearer ${d.A.state.accessToken}`}}),this.categories.splice(s,1),this.categoryMap.delete(e),this.serverMessage="카테고리가 정상적으로 삭제되었습니다.",this.showPopup=!0}catch(a){this.handle401Error(a)||console.error("Error removing category:",a)}else console.error("Category UUID not found")},closeResultPopup(){this.showPopup=!1,this.errorMsg=""}}};const L=(0,M.A)(f,[["render",u],["__scopeId","data-v-78b7e109"]]);var P=L}}]);
//# sourceMappingURL=325.50d483a8.js.map