"use strict";(self["webpackChunkdonggurami"]=self["webpackChunkdonggurami"]||[]).push([[796],{7796:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var s=a(6768),l=a(4232),i=a(5130),c=a(5039),n=a(6392);const r={class:"container"},o={class:"list"},u=["onClick"],d={class:"list-item-department"},p={class:"list-item-clubname"},b={class:"list-item-clubleader"},h={class:"list-item-numberOfClubMembers"},P={class:"list-item-delete"},m=["onClick"],v={class:"pagination"},k=["disabled"],g=["onClick"],C=["disabled"],f={key:0,class:"popup-overlay"},w={class:"popup"},L={class:"popup-message"},I={class:"popup-warning"};function D(e,t,a,D,y,A){const E=(0,s.g2)("Popup401");return(0,s.uX)(),(0,s.CE)(s.FK,null,[t[9]||(t[9]=(0,s.Fv)('<div class="title" data-v-91b1fc6c>동아리 리스트</div><div class="header" data-v-91b1fc6c><div class="header-row" data-v-91b1fc6c><div class="header-item-department" data-v-91b1fc6c>분과</div><div class="header-item-clubname" data-v-91b1fc6c>동아리 이름</div><div class="header-item-clubleader" data-v-91b1fc6c>동아리 회장</div><div class="header-item-numberOfClubMembers" data-v-91b1fc6c>인원</div><div class="header-item-delete" data-v-91b1fc6c></div></div></div>',2)),(0,s.Lk)("div",r,[(0,s.Lk)("div",o,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y.clubs,(e,t)=>((0,s.uX)(),(0,s.CE)("div",{class:"list-item-container",key:t},[(0,s.Lk)("div",{class:"list-item-row",onClick:t=>A.openPopupClubInfo(e)},[(0,s.Lk)("div",d,(0,l.v_)(e.department),1),(0,s.Lk)("div",p,(0,l.v_)(e.clubName),1),(0,s.Lk)("div",b,(0,l.v_)(e.leaderName),1),(0,s.Lk)("div",h,(0,l.v_)(e.numberOfClubMembers),1)],8,u),(0,s.Lk)("div",P,[(0,s.Lk)("button",{class:"delete-btn",onClick:(0,i.D$)(a=>A.openPopup(e.clubUUID,t,e.clubName),["stop"])},"삭제",8,m)])]))),128))]),(0,s.Lk)("div",v,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>A.prevPage&&A.prevPage(...e)),disabled:1===y.currentPage},t[5]||(t[5]=[(0,s.Lk)("img",{src:c,alt:"Previous"},null,-1)]),8,k),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y.totalPages,e=>((0,s.uX)(),(0,s.CE)("button",{key:e,onClick:t=>A.setPage(e),class:(0,l.C4)({active:e===y.currentPage})},(0,l.v_)(e),11,g))),128)),(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>A.nextPage&&A.nextPage(...e)),disabled:y.currentPage===y.totalPages},t[6]||(t[6]=[(0,s.Lk)("img",{src:n,alt:"Next"},null,-1)]),8,C)])]),y.isPopupVisible?((0,s.uX)(),(0,s.CE)("div",f,[(0,s.Lk)("div",w,[t[7]||(t[7]=(0,s.Lk)("h3",null,"동아리 삭제",-1)),t[8]||(t[8]=(0,s.Lk)("div",{class:"line2"},null,-1)),(0,s.Lk)("p",L,"'"+(0,l.v_)(y.PopupClubName)+"'을(를) 삭제하시겠습니까?",1),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>y.adminPw=e),type:"password",placeholder:"관리자 비밀번호를 입력해 주세요."},null,512),[[i.Jo,y.adminPw]]),(0,s.Lk)("p",I,(0,l.v_)(y.adminPwError),1),(0,s.Lk)("button",{class:"expel-button",onClick:t[3]||(t[3]=(...e)=>A.confirmDelete&&A.confirmDelete(...e))},"확인"),(0,s.Lk)("button",{class:"cancel-button",onClick:t[4]||(t[4]=(...e)=>A.cancelDelete&&A.cancelDelete(...e))},"취소")])])):(0,s.Q3)("",!0),y.show401Popup?((0,s.uX)(),(0,s.Wv)(E,{key:1})):(0,s.Q3)("",!0)],64)}var y=a(4373),A=a(5968),E=a(6799),U={name:"ClubProfile",components:{Popup401:E.A},data(){return{currentPage:1,clubsPerPage:10,clubs:[],totalPages:1,isPopupVisible:!1,isClubInfoPopupVisible:!1,adminPw:"",adminPwError:"",clubToDelete:null,deleteIndex:null,PopupClubName:null,show401Popup:!1}},created(){this.fetchClubs()},methods:{handle401Error(e){return!(!e.response||401!==e.response.status)&&(this.show401Popup=!0,!0)},async fetchClubs(){try{const e=await y.A.get(`${A.A.state.apiBaseUrl}/admin/clubs`,{headers:{Authorization:`Bearer ${A.A.state.accessToken}`},params:{page:this.currentPage-1,size:this.clubsPerPage}}),{content:t,totalPages:a}=e.data.data;this.clubs=t||[],this.totalPages=a||1}catch(e){this.handle401Error(e)||console.error("Error updating member:",e)}},async setPage(e){e>0&&e<=this.totalPages&&(this.currentPage=e,await this.fetchClubs())},async prevPage(){this.currentPage>1&&(this.currentPage--,await this.fetchClubs())},async nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,await this.fetchClubs())},openPopup(e,t,a){this.PopupClubName=a,this.clubToDelete=e,this.deleteIndex=t,this.isPopupVisible=!0},cancelDelete(){this.isPopupVisible=!1,this.adminPw="",this.adminPwError=""},async confirmDelete(){if(this.adminPw)try{await y.A.delete(`${A.A.state.apiBaseUrl}/admin/clubs/${this.clubToDelete}`,{headers:{Authorization:`Bearer ${A.A.state.accessToken}`},data:{adminPw:this.adminPw}}),this.clubs.splice(this.deleteIndex,1),this.isPopupVisible=!1,alert("동아리가 성공적으로 삭제되었습니다.")}catch(e){const{code:t}=e.response?.data||{};this.handle401Error(e)||("ADM-202"===t?this.adminPwError="* 비밀번호를 다시 확인해주세요.":"CLUB-201"===t?alert("존재하지않는 동아리 입니다."):"INVALID_UUID_FORMAT"===t?alert("유효하지 않은 UUID 형식입니다. 올바른 UUID를 입력하세요."):alert("예기치 못한 오류 발생"))}else alert("관리자 비밀번호를 입력하세요.")},openPopupClubInfo(e){localStorage.setItem("accessToken",A.A.state.accessToken);const t=715,a=820;window.open(`/club-popup?clubId=${e.clubUUID}`,"ClubInfo",`width=${t},height=${a},scrollbars=yes,resizable=yes`)}}},_=a(1241);const $=(0,_.A)(U,[["render",D],["__scopeId","data-v-91b1fc6c"]]);var x=$}}]);
//# sourceMappingURL=796.e9fdfae9.js.map